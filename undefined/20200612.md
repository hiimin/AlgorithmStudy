# 20200612

## 응용 계층 프로토콜

### http

1. 인터넷상에서 데이터를 주고 받기 위한 서버/클라이언트 모델을 따르는 프로토콜
2. html 문서, 이미지, 동영상, 오디오, 텍스트 문서 등을 주고 받을 수 있음
3. 클라이언트에서 요청\(requeust\), 서버는 요청을 처리해서 응답\(response\)한다.
4. port 80
5. 비연결성\(Connectionless\) : 클라이언트와 서버가 한 번 연결을 맺은 후, 클라이언트 요청에 대해 서버가 응답을 마치면 맺었던 연결을 끊어버리는 성질이다. 이유는 http는 인터넷 상에서 불특정 다수의 통신 환경을 기반으로 설계되어있는데 만약 서버에서 다수의 클라이언트와 연결을 계속 유지해야 한다면, 이에 따른 많은 리소스가 발생하기 때문에 연결을 유지하기 위한 리소스를 줄이면 더 많은 연결을 할 수 있으므로 비연결적인 특징을 갖는다. 서버는 클라이언트를 기억하고 있지 않으므로 동일한 클라이언트의 모든 요청에 대해, 매번 새로운 연결을 시도/해제의 과정을 거쳐야하므로 연결/해제에 대한 오버헤드가 발생한다는 단점이 있다.
6. 무상태 프로토콜\(stateless protocol\) : 이전 요청과 각각 무관한 요청을 독립적으로 처리한다는 의미이다. 클라이언트의 정보를 저장하지 않는다. connectionless로 인해 서버는 클라이언트를 식별할 수가 없는데, 이를 stateless라고 한다. 
7. 상태를 기억하는 방법\(쿠키\) : 부라우저 단에서 쿠키라는 것을 저장해서 서버가 클라이언트를 식별할 수 있도록 한다.

   ex\) 로그인 시 "아이디와 비밀번호를 저장하시겠습니까?", 쇼핑몰 장바구니 기능

8. 상태를 기억하는 방법\(세션\) : 브라우저가 아닌 서버단에 사용자 정보를 저장하는 구조이다. 쿠키는 사용자 정보가 브라우저에 저장되기 때문에 공격자로부터 위변조의 가능성이 높아 보안에 취학하다. 세션은 브라우저가 아닌 서버단에 사용자 정보를 저장하므로 쿠키보다 안전하다.

### dns

1. 일반적으로 udp 사용
2. port 53
3. 도메인을 IP로 변환하거나 IP를 도메인으로 다시 변경해주는 것을 말한다.
4. 동작 과정\(naver.com를 찾는다고 가정\)
   1. 로컬 dns에게 www.naver.com을 질의
   2. 로컬 dns가 root dns에게 www.naver.com 질의
   3. root dns가 com을 인식하고 com을 관리하는 최상위 도메인 dns 서버의 IP를 로컬 dns에게 알려준다
   4. 다시 로컬 dns가 com도메인을 관리하는 최상위 도메인 dns서버에게 www.naver.com을 질의한다.
   5. 최상위 도메인 dns 서버가 naver.com을 인식하고 naver.com을 관리하는 책임 dns서버의 IP를 로컬 dns에게 알려준다.
   6. 로컬 dns는 책임 dns 서버에게 www.naver.com을 질의하고
   7. 책임 dns 서버에서 www.naver.com 호스트에 대한 IP를 알려준다.
   8. 로컬 dns가 dns client에게 www.naver.com의 IP를 알려준다.
5. dns 캐싱 : 로컬 dns는 질의에 대해서 dns 서버로 부터 응답을 받을 때마다 dns 정보\(호스트 네임과 IP주소 쌍\)를 저장한다. 이때 다시 클라이언트로부터 같은 질의가 로컬 dns에게 도착한다면 해당 도메인에 대한 책임이 없더라도 해당 호스트네임에 대한 IP를 응답한다.

## 전송 계층 프로토

### tcp

1. 전송 제어 프로토콜, 네트워크의 정보전달을 통제하는 프로토콜
2. 네트워크 망에 연결된 컴퓨터의 프로그램 간 데이터를 순서대로, 에러없이 교환할 수 있게 하는 역할
3. 데이터의 전달을 보증하고 보낸 순서대로 받게 해줌
4. 3 way handshaking을 활용한 신뢰성 있는 전송 가능
5. 연결 지향 프로토콜
   * 물리적으로 전용회선이 연결되어 있는 것처럼 가상의 연결통로를 설정하여 통신하는 방식으로 가상의 연결통로를 가상회선이라 한다.
   * 논리적인 연결통로를 통해 데이터를 주고 받음으로써 데이터의 전송순서를 보장해준다. 순서제어라고도 한다.
   * 스트림 기반의 전송방식을 사용한다. 데이터를 임의의 크기로 나누어 연속해서 전송하는 방식을 사용한다.
6. 신뢰할 수 잇는 프로토콜
   * 흐름 제어 : 상대방이 받을 수 있을 만큼만 데이터를 효율적으로 전송하는 것. 데이터를 송신하는 곳과 수신하는 곳의 데이터 처리 속도를 조절하여 수신자의 버퍼 오버플로우를 방지하는 것. 흐름제어를 위해 슬라이딩 윈도우 방식을 사용한다. 이는 상대방이 수신 가능한 크기\(window size\) 내에서 데이터를 연속해서 전송하는 방식으로 매 세그먼트 전송 시마다 수신확인응답\(ack\)을 수신한 후 전송하게 되면 왕복시간\(RTT:Round Trip Time\)이 길 경우 당위 시간당 데이터 전송량이 메우 떨어지므로 효율적으로 전송하기 위해 상대방이 받을 수 있는 범위 내에서 연속적으로 전송한다.
   * 오류 제어 : 데이터의 오류나 누락없이 안전한 전송을 보장, 오류 또는 누락 발생 시 재전송을 수행하여 이를 보정
   * 혼잡 제어 : 네트워크의 혼잡 정도에 따라 송신자가 데이터 전송량을 제어하는 것을 말한다. 혼잡 정도에 대한 판단 기준은 데이터의 손실 발생 유무로 판단한다. 전송한 데이터에 누락이 발생하면 네트워크가 혼잡한 상태로 판단하여 전송량을 조절한다.

### udp

1. 비연결성이고 신뢰성이 없으며, 순서화되지 않은 Datagram 서비스 제공
2. tcp는 신뢰성이 낮은 프로그램에 적합
3. 비연결형 프로토콜
   * 논리적인 연결 설정 과정이 없기 때문에 데이터그램 전송 시마다 주소 정보를 설정해서 전송한다.
   * 데이터의 순차적 전송을 보장해주지 않는다.
   * 데이터그램 기반의 전송방식을 사용한다. 즉 데이터를 정해진 크기로 전송하는 방식을 사용한다.
4. 신뢰할 수 없는 프로토콜
   * 신뢰성 있는 tcp와 달리 흐름제어, 오류제어, 혼잡제어 등을 수행하지 않는다.
   * 실질적으로 IP 기반에 포트 정보를 이용하여 상위 송수신 어플리케이션을 식별해주는 역할 정도만 수행한다.
5. 단순하고 가벼운 프로토콜로 전송속도가 빠르다.
   * tcp의 경우 내부 처리 매커니즘에 의해 프로토콜이 복잡하고 무거운 방면 udp는 상대적으로 가볍고 단순한 프로토콜로 빠른 전송이 장점이다.
6. 비신뢰적인 특성으로 인해 대량 데이터의 송수신은 부적절하며 주로 한 번의 패킷 송수신으로 완료되는 서비스에 많이 사용된다. ex\) DNS, NTPM DHCP 등
7. 해더의 checkSum 필드를 통해 최소한의 오류만 검출한다.
8. 신뢰성보다는 연속성이 중요한 서비스 예를 들면 실시산 서비스\(streaming\)에 자주 사용된다.

{% embed url="http://melonicedlatte.com/network/2018/12/24/161629.html" %}

## 네트워크 계층 프로토

### IP

1. 호스트에서 다른 호스트까지 데이터를 전송해주는 것이 목적
2. 패킷 교환 네트워크에서 정보를 주고받는데 사용하는 정보 위주의 규약
3. 호스트의 주소지정과 패킷 분할 및 조립 기능을 담당

### ICMP\(Internet Control Message Protocol\)

1. 데이터 전송 중에 문제가 생길 경우 장애 상황을 통보하기 위해 사용된다.
2. tcp와 다르게 ip는 신뢰성을 보장하지 않기 때문에 데이터를 보낸곳에 그냥 단순히 오류가 났다고 메시지만 전달해줌
3. 오류 발생시 오류 메세지를 보내는 프로토콜

### ARP

 목적지의 IP 주소만 알고있을 경우 ARP 패킷 브로드캐스트를 통해서 목적지의 Mac 주소를 알수있음

### IGMP\(Internet Group Message Protocol\)

1. 인터넷 그룹 관리 프로토콜로 불리기도 한다.
2. 한 컴퓨터가 멀티캐스트 그룹을 사용할 수 있다고 주변의 라우터들에게 알려주는 인터넷 프로토콜
3. 하나의 라우터와 여러 호스트로 구성되는 서브네트워크상에서 라우터가 자신에 속한 호스트들이 어떤 멀티캐스트 그룹에 속하는 가를 알기위한 일종의 그룹관리용 신호 프로토콜
4. 로컬 네트워크에서 멀티캐스트 그룹에 속해있는 호스트들을 알려주는 제어 프로토콜
5. 질의, 응답을 통한 주기적인 확인
6. 로컬 서브네트워크를 벗어나면 폐기된다.
7. 동작방식
   * 멀티캐스트 라우터는 주기적으로 subnet 호스트 그룹들에게 IGMP Query 메시지를 전송한다.
   * 호스트는 IGMP Query 메시지에 응답하며, 자신이 가입하고자 하는 그룹주소 정보를 IGMP Report 메시지를 통해 라우터에게 알려준다.
   * 한편, 호스트는 Query 메시지 없이도 먼저 Report 메시지를 라우터에게 전송할 수 있다.
8. 라우터가 LAN안에서 우리들에게 멀티캐스트 패킷을 분배하는 경우에 사용됨. 쉽게 말해 멀티캐스팅을 할 수 있는 PC들을 IGMP가 라우터에게 알리는 역할을 한다. 멀티캐스트 패킷을 수신한 라우터는 IGMP로 수신을 선언한 PC가 있을 경우에만 패킷을 PC가 접속하는 LAN 세그먼트에 송신한다. 이렇게 하면 정보중복전송과 IP트래픽이 과도하게 흐르지 않게됨.

EX\)

*  IGMP : 동아리 회원 관리자 
* 라우터 : 동아리 회장 
* PC : 학생

1. 그룹 가입\(joining\) - 학생들이 동아리 회원 관리자를 통해 동아리 가입을 요청 

    2. 그룹 멤버쉽 조사\(monitoring\) - 동아리에 들어오고 싶은지 회원 관리자가 물어보고 답장이 올 때까지 기다림.

    3.  멤버쉽 연속\(member continuation\) - 가입이 확정되고도 지속적으로 활동을 할건지 여부를 결정한 후 회장에게 최종 메세지를 보냄 

    4. 그룹 탈퇴\(leaving\) - 탈퇴한 학생은 더 이상 동아리 소식을 들을 수 없음

